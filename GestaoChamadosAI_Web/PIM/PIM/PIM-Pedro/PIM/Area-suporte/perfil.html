<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Atendente • Perfil</title>
  <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/css/theme.css" rel="stylesheet">
</head>
<body data-page="a-perfil">
  <div class="app-wrapper">
    <nav class="sidebar d-flex flex-column">
      <div class="brand">
        <button class="btn btn-sm btn-light d-lg-none me-2" data-toggle="sidebar"><i class="bi bi-list"></i></button>
        <img src="../assets/img/logo.png" alt="" onerror="this.style.display='none'">
        <span class="brand-name">PIM</span>
      </div>
      <ul class="nav nav-pills flex-column gap-1">
        <li class="nav-item"><a class="nav-link" href="index.html"><i class="bi bi-speedometer2"></i><span>Dashboard</span></a></li>
  <li class="nav-item"><a class="nav-link" href="chamados.html"><i class="bi bi-ticket-detailed"></i><span>Meus Chamados</span></a></li>
  <!-- Item Configurações removido -->
      </ul>
    </nav>

    <nav class="app-header navbar navbar-light bg-white px-3">
      <div class="d-flex align-items-center gap-2">
        <button class="btn btn-outline-secondary d-none d-lg-inline" title="Recolher" data-toggle="collapse-sidebar"><i class="bi bi-layout-sidebar-inset"></i></button>
        <button class="btn btn-outline-secondary d-lg-none" data-toggle="sidebar"><i class="bi bi-list"></i></button>
      </div>
      <div class="ms-auto d-flex align-items-center gap-3">
        <span class="header-chip d-none d-md-inline">SLA: 4h resposta</span>
        <div class="dropdown">
          <a class="nav-link position-relative" href="#" title="Notificações" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-bell"></i>
            <span class="notif-badge position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
          </a>
          <div class="dropdown-menu dropdown-menu-end p-0 notif-menu"></div>
        </div>
        <div class="dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown"><i class="bi bi-person-circle me-1"></i> Você</a>
          <div class="dropdown-menu dropdown-menu-end">
            <a class="dropdown-item" href="perfil.html">Perfil</a>
          </div>
        </div>
      </div>
    </nav>

    <main class="app-content container-fluid">
      <div class="container-xxl">
        <div class="row g-3">
          <div class="col-12 col-lg-8">
            <div class="card p-3">
              <h5 class="mb-3">Seu perfil</h5>
              <form id="a-profile-form" class="row g-3">
                <div class="col-12 col-md-6">
                  <label class="form-label">Nome</label>
                  <input id="p-name" class="form-control" placeholder="Seu nome">
                </div>
                <div class="col-12 col-md-6">
                  <label class="form-label">E-mail</label>
                  <input id="p-email" type="email" class="form-control" placeholder="voce@email.com">
                </div>
                <div class="col-12 col-md-6">
                  <label class="form-label">Senha</label>
                  <div class="input-group">
                    <input id="p-pass" type="password" class="form-control" placeholder="••••••">
                    <button class="btn btn-outline-secondary" type="button" id="p-toggle"><i class="bi bi-eye"></i></button>
                  </div>
                </div>
                <div class="col-12 col-md-6">
                  <label class="form-label">Avatar</label>
                  <input id="p-avatar" type="file" class="form-control" accept="image/*">
                </div>
                <div class="col-12">
                  <div class="form-check">
                    <input id="p-email-notif" class="form-check-input" type="checkbox">
                    <label class="form-check-label" for="p-email-notif">Receber notificações por e-mail</label>
                  </div>
                </div>
                <div class="col-12">
                  <button class="btn btn-primary" type="submit">Salvar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="../bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/js/data.js"></script>
  <script src="../assets/js/app.js"></script>
  <script>
    (function(){
      const form = document.getElementById('a-profile-form');
      const nameEl = document.getElementById('p-name');
      const emailEl= document.getElementById('p-email');
      const passEl = document.getElementById('p-pass');
      const togEl  = document.getElementById('p-toggle');
      const avEl   = document.getElementById('p-avatar');
      const mailEl = document.getElementById('p-email-notif');
      const saved = JSON.parse(localStorage.getItem('profile')||'{}');
      nameEl.value = saved.name||'';
      emailEl.value= saved.email||'';
      passEl.value = saved.password||'';
      mailEl.checked = !!saved.emailNotifications;
      togEl.addEventListener('click',()=>{
        if(passEl.type==='password'){ passEl.type='text'; togEl.innerHTML='<i class="bi bi-eye-slash"></i>'; }
        else { passEl.type='password'; togEl.innerHTML='<i class="bi bi-eye"></i>'; }
      });
      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        const p = Object.assign({}, saved, {
          name: nameEl.value.trim(),
          email: emailEl.value.trim(),
          password: passEl.value,
          emailNotifications: mailEl.checked
        });
        localStorage.setItem('profile', JSON.stringify(p));
        const alertDiv = document.createElement('div');
        alertDiv.className='alert alert-success mt-3';
        alertDiv.textContent='Perfil salvo com sucesso';
        form.appendChild(alertDiv);
        setTimeout(()=>alertDiv.remove(), 2000);
      });
      try{ renderNotifications(); }catch{}
    })();
  </script>
</body>
</html>
