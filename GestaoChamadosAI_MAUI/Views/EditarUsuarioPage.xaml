<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:GestaoChamadosAI_MAUI.ViewModels"
             xmlns:behaviors="clr-namespace:GestaoChamadosAI_MAUI.Behaviors"
             x:Class="GestaoChamadosAI_MAUI.Views.EditarUsuarioPage"
             x:DataType="viewmodels:EditarUsuarioViewModel"
             Title="Editar UsuÃ¡rio"
             Shell.BackgroundColor="{StaticResource Primary}">

    <ScrollView>
        <VerticalStackLayout Padding="0" Spacing="0">
            <!-- Logo Header -->
            <Grid BackgroundColor="{StaticResource Primary}" Padding="20,15,20,15">
                <Image Source="logo.png" WidthRequest="35" HeightRequest="35" HorizontalOptions="Start" VerticalOptions="Center"/>
            </Grid>
            
            <VerticalStackLayout Padding="20" Spacing="20">
                <!-- Header -->
                <Frame BackgroundColor="White" CornerRadius="12" Padding="20" HasShadow="True">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="âœï¸ Editar UsuÃ¡rio" FontSize="24" FontAttributes="Bold" TextColor="{StaticResource Primary}"/>
                    <Label Text="Atualize os dados do usuÃ¡rio selecionado" FontSize="14" TextColor="{StaticResource Gray600}"/>
                </VerticalStackLayout>
            </Frame>

            <!-- FormulÃ¡rio -->
            <Frame BackgroundColor="White" CornerRadius="12" Padding="20" HasShadow="True">
                <VerticalStackLayout Spacing="15">

                    <!-- Nome -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Nome Completo *" FontSize="14" FontAttributes="Bold"/>
                        <Entry Placeholder="Digite o nome do usuÃ¡rio"
                               Text="{Binding Nome}"
                               BackgroundColor="{StaticResource Gray100}"
                               HeightRequest="50"/>
                    </VerticalStackLayout>

                    <!-- Email -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Email *" FontSize="14" FontAttributes="Bold"/>
                        <Entry Placeholder="email@exemplo.com"
                               Text="{Binding Email}"
                               Keyboard="Email"
                               BackgroundColor="{StaticResource Gray100}"
                               HeightRequest="50"/>
                    </VerticalStackLayout>

                    <!-- Tipo -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Tipo de UsuÃ¡rio *" FontSize="14" FontAttributes="Bold"/>
                        <Picker ItemsSource="{Binding TiposDisponiveis}"
                                SelectedItem="{Binding Tipo}"
                                BackgroundColor="{StaticResource Gray100}"
                                HeightRequest="50"/>
                    </VerticalStackLayout>

                    <BoxView HeightRequest="1" BackgroundColor="{StaticResource Gray300}" Margin="0,10"/>

                    <!-- Alterar Senha -->
                    <HorizontalStackLayout Spacing="10">
                        <CheckBox IsChecked="{Binding AlterarSenha}" 
                                  Color="{StaticResource Primary}"
                                  VerticalOptions="Center"/>
                        <Label Text="Alterar Senha" 
                               FontSize="14" 
                               FontAttributes="Bold"
                               VerticalOptions="Center">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding Source={x:Reference AlterarSenhaCheckbox}, Path=BindingContext.AlterarSenha}"/>
                            </Label.GestureRecognizers>
                        </Label>
                    </HorizontalStackLayout>

                    <VerticalStackLayout Spacing="15" IsVisible="{Binding AlterarSenha}">
                        <!-- Nova Senha -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Nova Senha *" FontSize="14" FontAttributes="Bold"/>
                            <Entry Placeholder="Digite a nova senha (mÃ­nimo 6 caracteres)"
                                   Text="{Binding Senha}"
                                   IsPassword="True"
                                   BackgroundColor="{StaticResource Gray100}"
                                   HeightRequest="50"/>
                        </VerticalStackLayout>

                        <!-- Confirmar Nova Senha -->
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Confirmar Nova Senha *" FontSize="14" FontAttributes="Bold"/>
                            <Entry Placeholder="Digite a senha novamente"
                                   Text="{Binding ConfirmarSenha}"
                                   IsPassword="True"
                                   BackgroundColor="{StaticResource Gray100}"
                                   HeightRequest="50"/>
                        </VerticalStackLayout>

                        <Label Text="ðŸ’¡ Deixe em branco se nÃ£o quiser alterar a senha" 
                               FontSize="11" 
                               TextColor="{StaticResource Warning}"
                               FontAttributes="Italic"/>
                    </VerticalStackLayout>

                    <BoxView HeightRequest="1" BackgroundColor="{StaticResource Gray300}" Margin="0,10"/>

                    <Label Text="* Campos obrigatÃ³rios" 
                           FontSize="12" 
                           TextColor="{StaticResource Gray600}"
                           FontAttributes="Italic"/>

                </VerticalStackLayout>
            </Frame>

            <!-- BotÃµes - RESPONSIVO -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Grid.Behaviors>
                    <behaviors:ResponsiveGridBehavior Columns="2"/>
                </Grid.Behaviors>
                <Button Grid.Column="0"
                        Text="âŒ Cancelar"
                        Command="{Binding CancelarCommand}"
                        BackgroundColor="{StaticResource Gray500}"
                        HeightRequest="50"/>

                <Button Grid.Column="1"
                        Text="ðŸ’¾ Salvar AlteraÃ§Ãµes"
                        Command="{Binding SalvarCommand}"
                        BackgroundColor="{StaticResource Success}"
                        HeightRequest="50"/>
            </Grid>

            <!-- Loading -->
            <ActivityIndicator IsRunning="{Binding IsLoading}" 
                             IsVisible="{Binding IsLoading}" 
                             Color="{StaticResource Primary}"
                             Margin="0,20"/>

            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
