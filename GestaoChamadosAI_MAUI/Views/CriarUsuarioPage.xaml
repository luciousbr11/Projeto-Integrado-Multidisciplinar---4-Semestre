<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:GestaoChamadosAI_MAUI.ViewModels"
             xmlns:behaviors="clr-namespace:GestaoChamadosAI_MAUI.Behaviors"
             x:Class="GestaoChamadosAI_MAUI.Views.CriarUsuarioPage"
             x:DataType="viewmodels:CriarUsuarioViewModel"
             Title="Novo Usuário"
             Shell.BackgroundColor="{StaticResource Primary}">

    <ScrollView>
        <VerticalStackLayout Padding="0" Spacing="0">
            
            <!-- Header com Logo -->
            <Grid BackgroundColor="{StaticResource Primary}" Padding="20,15,20,15">
                <Image Source="logo.png"
                       WidthRequest="35"
                       HeightRequest="35"
                       HorizontalOptions="Start"
                       VerticalOptions="Center"/>
            </Grid>

            <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Header -->
            <Frame BackgroundColor="White" CornerRadius="12" Padding="20" HasShadow="True">
                <VerticalStackLayout Spacing="10">
                    <Label Text="➕ Criar Novo Usuário" FontSize="24" FontAttributes="Bold" TextColor="{StaticResource Primary}"/>
                    <Label Text="Preencha os dados para cadastrar um novo usuário no sistema" FontSize="14" TextColor="{StaticResource Gray600}"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Formulário -->
            <Frame BackgroundColor="White" CornerRadius="12" Padding="20" HasShadow="True">
                <VerticalStackLayout Spacing="15">

                    <!-- Nome -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Nome Completo *" FontSize="14" FontAttributes="Bold"/>
                        <Entry Placeholder="Digite o nome do usuário"
                               Text="{Binding Nome}"
                               BackgroundColor="{StaticResource Gray100}"
                               HeightRequest="50"/>
                    </VerticalStackLayout>

                    <!-- Email -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Email *" FontSize="14" FontAttributes="Bold"/>
                        <Entry Placeholder="email@exemplo.com"
                               Text="{Binding Email}"
                               Keyboard="Email"
                               BackgroundColor="{StaticResource Gray100}"
                               HeightRequest="50"/>
                        <Label Text="Este email será usado para login no sistema" 
                               FontSize="11" 
                               TextColor="{StaticResource Gray600}"/>
                    </VerticalStackLayout>

                    <!-- Tipo -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Tipo de Usuário *" FontSize="14" FontAttributes="Bold"/>
                        <Picker ItemsSource="{Binding TiposDisponiveis}"
                                SelectedItem="{Binding Tipo}"
                                TextColor="Black"
                                BackgroundColor="{StaticResource Gray100}"
                                HeightRequest="50"/>
                        <Label FontSize="11" TextColor="{StaticResource Gray600}">
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span Text="• "/>
                                    <Span Text="Cliente" FontAttributes="Bold"/>
                                    <Span Text=": Pode abrir e acompanhar chamados"/>
                                    <Span Text="&#10;• "/>
                                    <Span Text="Suporte" FontAttributes="Bold"/>
                                    <Span Text=": Atende e resolve chamados"/>
                                    <Span Text="&#10;• "/>
                                    <Span Text="Administrador" FontAttributes="Bold"/>
                                    <Span Text=": Acesso total ao sistema"/>
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>
                    </VerticalStackLayout>

                    <!-- Senha -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Senha *" FontSize="14" FontAttributes="Bold"/>
                        <Entry Placeholder="Digite a senha (mínimo 6 caracteres)"
                               Text="{Binding Senha}"
                               IsPassword="True"
                               BackgroundColor="{StaticResource Gray100}"
                               HeightRequest="50"/>
                    </VerticalStackLayout>

                    <!-- Confirmar Senha -->
                    <VerticalStackLayout Spacing="5">
                        <Label Text="Confirmar Senha *" FontSize="14" FontAttributes="Bold"/>
                        <Entry Placeholder="Digite a senha novamente"
                               Text="{Binding ConfirmarSenha}"
                               IsPassword="True"
                               BackgroundColor="{StaticResource Gray100}"
                               HeightRequest="50"/>
                    </VerticalStackLayout>

                    <BoxView HeightRequest="1" BackgroundColor="{StaticResource Gray300}" Margin="0,10"/>

                    <Label Text="* Campos obrigatórios" 
                           FontSize="12" 
                           TextColor="{StaticResource Gray600}"
                           FontAttributes="Italic"/>

                </VerticalStackLayout>
            </Frame>

            <!-- Botões - RESPONSIVO -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Grid.Behaviors>
                    <behaviors:ResponsiveGridBehavior Columns="2"/>
                </Grid.Behaviors>
                <Button Grid.Column="0"
                        Text="❌ Cancelar"
                        Command="{Binding CancelarCommand}"
                        BackgroundColor="{StaticResource Gray500}"
                        HeightRequest="50"/>

                <Button Grid.Column="1"
                        Text="✅ Salvar"
                        Command="{Binding SalvarCommand}"
                        BackgroundColor="{StaticResource Success}"
                        HeightRequest="50"/>
            </Grid>

            <!-- Loading -->
            <ActivityIndicator IsRunning="{Binding IsLoading}" 
                             IsVisible="{Binding IsLoading}" 
                             Color="{StaticResource Primary}"
                             Margin="0,20"/>

            </VerticalStackLayout>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
